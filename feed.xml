<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.9.2">Jekyll</generator><link href="https://chuckleplant.github.io/feed.xml" rel="self" type="application/atom+xml" /><link href="https://chuckleplant.github.io/" rel="alternate" type="text/html" /><updated>2022-09-24T23:32:37+02:00</updated><id>https://chuckleplant.github.io/feed.xml</id><title type="html">Chuck LePlant</title><subtitle>Sergio Basurco&apos;s personal portfolio. I&apos;m a game developer based in Barcelona. Have fun browsing my little projects.
</subtitle><author><name>Sergio Basurco</name></author><entry><title type="html">Tequila Doodles</title><link href="https://chuckleplant.github.io/2022/09/21/tequila-doodles.html" rel="alternate" type="text/html" title="Tequila Doodles" /><published>2022-09-21T00:00:00+02:00</published><updated>2022-09-21T00:00:00+02:00</updated><id>https://chuckleplant.github.io/2022/09/21/tequila-doodles</id><content type="html" xml:base="https://chuckleplant.github.io/2022/09/21/tequila-doodles.html"><![CDATA[<p>Little doodles that I drew while working at Tequila Works in Madrid. I blame compilation times and a cloud of creativity floating around the office. Some are related to Gylt, a game we shipped for Google Stadia. Others are just rough drawings made absent-mindedly.</p>

<div id="pig"></div>
<script src="/js/plugins/pig/src/pig.min.js"></script>
<script>
                              var imageData = [{filename: "Tequila Doodles/Springy.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Springy/"},{filename: "Tequila Doodles/Surrounded.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Surrounded/"},{filename: "Tequila Doodles/UI Wedges.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/UI-Wedges/"},{filename: "Tequila Doodles/Door.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Door/"},{filename: "Tequila Doodles/Ball Hand.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Ball-Hand/"},{filename: "Tequila Doodles/Twitter.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Twitter/"},{filename: "Tequila Doodles/Doggo.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Doggo/"},{filename: "Tequila Doodles/Mario Maybe.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Mario-Maybe/"},{filename: "Tequila Doodles/Earth.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Earth/"},{filename: "Tequila Doodles/Batman.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Batman/"},{filename: "Tequila Doodles/Architecture.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Architecture/"},{filename: "Tequila Doodles/Pinky.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Pinky/"},{filename: "Tequila Doodles/Avocadudes.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Avocadudes/"},{filename: "Tequila Doodles/Eyescrew.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Eyescrew/"},{filename: "Tequila Doodles/Eye in mouth.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Eye-in-mouth/"},{filename: "Tequila Doodles/Plane.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Plane/"},{filename: "Tequila Doodles/Pyramidst.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Pyramidst/"},{filename: "Tequila Doodles/Aboatcado.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Aboatcado/"},{filename: "Tequila Doodles/Chachacha.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Chachacha/"},{filename: "Tequila Doodles/Battery.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Battery/"},{filename: "Tequila Doodles/Avocat.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Avocat/"},{filename: "Tequila Doodles/In motion.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/In-motion/"},{filename: "Tequila Doodles/Smash.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Smash/"},{filename: "Tequila Doodles/Lava Tears.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Lava-Tears/"},{filename: "Tequila Doodles/Ventana Avise Cerrado.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Ventana-Avise-Cerrado/"},{filename: "Tequila Doodles/Horns.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Horns/"},{filename: "Tequila Doodles/Eye Closeup.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Eye-Closeup/"},{filename: "Tequila Doodles/Angel Toad.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Angel-Toad/"},{filename: "Tequila Doodles/Tilting Bird.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Tilting-Bird/"},{filename: "Tequila Doodles/Hawkish.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Hawkish/"},{filename: "Tequila Doodles/Plankton.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Plankton/"},{filename: "Tequila Doodles/Dinosaur.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Dinosaur/"},{filename: "Tequila Doodles/Puppet.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Puppet/"},{filename: "Tequila Doodles/Fire Extinguisher Diegetic.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Fire-Extinguisher-Diegetic/"},{filename: "Tequila Doodles/Devil.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Devil/"},{filename: "Tequila Doodles/Gylt Title.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Gylt-Title/"},{filename: "Tequila Doodles/Tattoed.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Tattoed/"},{filename: "Tequila Doodles/Tapetum.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Tapetum/"},{filename: "Tequila Doodles/Bowser Maybe.jpg", aspectRatio: 1.158483530142946, url: "/img/albums/Tequila Doodles/Bowser-Maybe/"},{filename: "Tequila Doodles/Bird.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Bird/"},{filename: "Tequila Doodles/Gun Hands.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Gun-Hands/"},{filename: "Tequila Doodles/Hide'n'seek.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Hidenseek/"},{filename: "Tequila Doodles/Hammer Wedge.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Hammer-Wedge/"},{filename: "Tequila Doodles/Rarebit.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Rarebit/"},{filename: "Tequila Doodles/Snake Mammal.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Snake-Mammal/"},{filename: "Tequila Doodles/Interesing Owl.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Interesing-Owl/"},{filename: "Tequila Doodles/A dude.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/A-dude/"},{filename: "Tequila Doodles/Maze.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Maze/"},{filename: "Tequila Doodles/Tarel.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Tarel/"},{filename: "Tequila Doodles/Monkey Island-ish Pirate.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Monkey-Island-ish-Pirate/"},{filename: "Tequila Doodles/Abstract ship.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Abstract-ship/"},{filename: "Tequila Doodles/Rimewitness.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Rimewitness/"},{filename: "Tequila Doodles/Banach-Tarski.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Banach-Tarski/"},{filename: "Tequila Doodles/Parrot Viking.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Parrot-Viking/"},{filename: "Tequila Doodles/Comic.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Comic/"},{filename: "Tequila Doodles/Skulled.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Skulled/"},{filename: "Tequila Doodles/Barbarian Blob.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Barbarian-Blob/"},{filename: "Tequila Doodles/Psychic Cowboy Draft.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Psychic-Cowboy-Draft/"},{filename: "Tequila Doodles/Psychic Cowboy.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Tequila Doodles/Psychic-Cowboy/"},{filename: "Tequila Doodles/Muay Thai Cleric.jpg", aspectRatio: 0.75, url: "/img/albums/Tequila Doodles/Muay-Thai-Cleric/"},];
                              var options = {
                                urlForSize: function(filename, size) {
                                  return '/img/' + size + '/' + filename;
                                },
                                figureTagName: "a",
                                transitionSpeed: 500,
                                getMinAspectRatio: function(lastWindowWidth) {
                                if (lastWindowWidth <= 640)  // Phones
                                  return 1;
                                else if (lastWindowWidth <= 1280)  // Tablets
                                  return 3;
                                else if (lastWindowWidth <= 1920)  // Laptops
                                  return 4;
                                return 5;  // Large desktops
                              },
                                spaceBetweenImages: 3,
                                getImageSize: function(lastWindowWidth) {
                                  return 250;
                                }
                                // ...
                              };
                          
                              var pig = new Pig(imageData, options).enable();
                            </script>]]></content><author><name>Sergio Basurco</name></author><category term="drawing" /><category term="gamedev" /><category term="album" /><summary type="html"><![CDATA[Little doodles that I drew while working at Tequila Works in Madrid. I blame compilation times and a cloud of creativity floating around the office. Some are related to Gylt, a game we shipped for Google Stadia. Others are just rough drawings made absent-mindedly.]]></summary><media:thumbnail xmlns:media="http://search.yahoo.com/mrss/" url="https://chuckleplant.github.io/img/albums/Tequila%20Doodles/Smash.jpg" /><media:content medium="image" url="https://chuckleplant.github.io/img/albums/Tequila%20Doodles/Smash.jpg" xmlns:media="http://search.yahoo.com/mrss/" /></entry><entry><title type="html">Glimpse from Spirited Away</title><link href="https://chuckleplant.github.io/2018/12/11/spirited-painting.html" rel="alternate" type="text/html" title="Glimpse from Spirited Away" /><published>2018-12-11T00:00:00+01:00</published><updated>2018-12-11T00:00:00+01:00</updated><id>https://chuckleplant.github.io/2018/12/11/spirited-painting</id><content type="html" xml:base="https://chuckleplant.github.io/2018/12/11/spirited-painting.html"><![CDATA[<p>This image appears within a long scene in which Chihiro takes a train. The scene gives the viewer a break and portrays the protagonist’s journey from childhood to adulthood.</p>

<p>This shot appears for just a few seconds. It’s a beautifully composed image that instantly takes you in and leaves you wondering.</p>

<p>A small cozy house in a lonely island. In the foreground we see a very welcoming scene, while in the back some dark clouds are creeping in. In the horizon, darkness and light meet separated by a very thin line.</p>

<div class="Container">
    <div class="Content">
<img class="imagedropshadow" src="/images/spirited.png" alt="September 12th, 2018. 18x23cm. Acrylic on canvas." />  
    </div>
</div>
<p><span class="caption" style="font-size: 80%"><i>September 12th, 2018. 18x23cm. Acrylic on canvas.</i></span></p>]]></content><author><name>Sergio Basurco</name></author><category term="painting" /><category term="art" /><category term="images" /><category term="movies" /><category term="movie" /><category term="acrylic" /><summary type="html"><![CDATA[This image appears within a long scene in which Chihiro takes a train. The scene gives the viewer a break and portrays the protagonist’s journey from childhood to adulthood.]]></summary></entry><entry><title type="html">Jekyll pig image gallery</title><link href="https://chuckleplant.github.io/2018/08/06/pig-img-gallery.html" rel="alternate" type="text/html" title="Jekyll pig image gallery" /><published>2018-08-06T00:00:00+02:00</published><updated>2018-08-06T00:00:00+02:00</updated><id>https://chuckleplant.github.io/2018/08/06/pig-img-gallery</id><content type="html" xml:base="https://chuckleplant.github.io/2018/08/06/pig-img-gallery.html"><![CDATA[<p>A few posts ago I added image galleries. In the menu above you can access albums and the Life Drawing gallery. Initially I used the <a href="https://github.com/aerobless/jekyll-photo-gallery">Jekyll Photo Gallery</a> (JPG) by Theo Winter, which had many of the features I wanted. I liked specially the generation of a unique page for each photo and the google maps thumbnail generation. The JPG used the <a href="http://miromannino.github.io/Justified-Gallery/">Justified Gallery</a> by Miro Mannino to show a grid of images.</p>

<p>I noticed that for a great amount of images the site took too much time to load. After a small search I found the <a href="https://github.com/schlosser/pig.js">Progressive Image Grid</a> (PIG) by Dan Schlosser, this gallery could load an absurd amount of images without much effort. It does this by loading and unloading the images, buffering them based on the user’s browsing direction.</p>

<h2 id="changes-to-jekyll-photo-gallery">Changes to Jekyll Photo Gallery</h2>

<p>First I made a few changes to the <code class="language-plaintext highlighter-rouge">photo.html</code> layout from the original JPG. I changed where the map was placed and increased the map size for a higher resolution view. I also made the elements responsive and added a few icons based on the flickr layout.</p>

<p>The image layout acts in a similar way to how YouTube does for videos, it keeps a maximum height, which responds to the user shrinking the window width. I also added arrows on each side for feedback, this way the users know they can navigate by clicking.</p>

<div class="Container">
    <div class="Content">
<img class="imagedropshadow" src="/images/photo-page.png" alt="The photo page shows all relevant information from each image. The map static image was changed to occupy the blog's wrapper width." />  
    </div>
</div>
<p><span class="caption" style="font-size: 80%"><i>The photo page shows all relevant information from each image. The map static image was changed to occupy the blog’s wrapper width.</i></span></p>

<p>A big change on performance was precomputing all the exif data to be used in the photo page. In the original JPG these were called via Liquid script when generating the page. This happened each time Jekyll was built. Given that I made a script to set up photos and thumbnails in Python, I also made it so that all the required exif data was pregenerated just once. It is saved to a YAML file and used directly by Jekyll. The site generation time was basically halved by this.</p>

<h2 id="changes-to-progressive-image-grid">Changes to Progressive Image Grid</h2>

<p>The first challenge was to make PIG usable from Jekyll. Luckily JPG had already set the pathway to do this. I only had to replace the Justified Gallery code with PIG code.</p>

<p>For the actual PIG code I did have to make the images clickable, I added a <code class="language-plaintext highlighter-rouge">url</code> field for the images list. Then in JavaScript I created a <code class="language-plaintext highlighter-rouge">div</code> element to act as the captions. I shamelessly copied the captions from Justified Gallery, including the hover behaviour and animations.</p>

<h2 id="how-to-use-this-in-your-jekyll-site">How to use this in your Jekyll site</h2>

<p>If you’d like to use this image gallery you can grab <a href="https://github.com/chuckleplant/blog/tree/pig-gallery">this commit</a>. It will come in handy in case I change the theme or add too many custom features to my blog. At the moment of writing I’m using the default Jekyll minimal theme.</p>

<p>All you need to do to set it up is place your images in the following folder structure:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./
    img/
        albums/
            Hawaii/
            Alderaan/
            Another Album/
            ...
</code></pre></div></div>

<p>Then run the <code class="language-plaintext highlighter-rouge">setup-photos.py</code> script, in the scripts folder. This script will do the following:</p>

<ul>
  <li>Rotate your images according to the orientation specified by the metadata.</li>
  <li>Create thumbnails of height 20px and 250px, used by the PIG code.</li>
  <li>Create a YAML file for each album, describing all the images.</li>
  <li>All metadata found in the EXIF of your JPEGs will be written to the YAML descriptor. Later to be used in the photo page.</li>
</ul>

<p>Use the following snippet to insert an album anywhere in a post.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code> { %includeGallery ALBUM_ID% }
</code></pre></div></div>

<p>That should be it, run <code class="language-plaintext highlighter-rouge">jekyll serve --watch</code> to generate your site and you should be able to see your albums.</p>]]></content><author><name>Sergio Basurco</name></author><category term="meta" /><category term="jekyll" /><category term="images" /><summary type="html"><![CDATA[A few posts ago I added image galleries. In the menu above you can access albums and the Life Drawing gallery. Initially I used the Jekyll Photo Gallery (JPG) by Theo Winter, which had many of the features I wanted. I liked specially the generation of a unique page for each photo and the google maps thumbnail generation. The JPG used the Justified Gallery by Miro Mannino to show a grid of images.]]></summary></entry><entry><title type="html">Trip to Japan</title><link href="https://chuckleplant.github.io/2018/07/23/japan-trip.html" rel="alternate" type="text/html" title="Trip to Japan" /><published>2018-07-23T00:00:00+02:00</published><updated>2018-07-23T00:00:00+02:00</updated><id>https://chuckleplant.github.io/2018/07/23/japan-trip</id><content type="html" xml:base="https://chuckleplant.github.io/2018/07/23/japan-trip.html"><![CDATA[<p>I went to Japan last year. Precisely for this trip I bought a decent digital camera and started taking pictures as a hobby. I spent some time editing some of the photos, here’s a small selection of my favourites.</p>

<div id="pig"></div>
<script src="/js/plugins/pig/src/pig.min.js"></script>
<script>
                              var imageData = [{filename: "Japan/P8180162.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8180162/"},{filename: "Japan/P8200327.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8200327/"},{filename: "Japan/P8200926.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8200926/"},{filename: "Japan/P8200943.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8200943/"},{filename: "Japan/P8200949.jpg", aspectRatio: 0.7503751875937968, url: "/img/albums/Japan/P8200949/"},{filename: "Japan/P8201052.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8201052/"},{filename: "Japan/P8211215.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8211215/"},{filename: "Japan/P8211229.jpg", aspectRatio: 1.6733931240657698, url: "/img/albums/Japan/P8211229/"},{filename: "Japan/P8211572.jpg", aspectRatio: 1.5466954022988506, url: "/img/albums/Japan/P8211572/"},{filename: "Japan/P8221932.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8221932/"},{filename: "Japan/P8221953.jpg", aspectRatio: 1.4574616457461647, url: "/img/albums/Japan/P8221953/"},{filename: "Japan/P8221977.jpg", aspectRatio: 1.33422281521014, url: "/img/albums/Japan/P8221977/"},{filename: "Japan/P8222072.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8222072/"},{filename: "Japan/P8222094.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8222094/"},{filename: "Japan/P8222140.jpg", aspectRatio: 0.7503751875937968, url: "/img/albums/Japan/P8222140/"},{filename: "Japan/P8222148.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8222148/"},{filename: "Japan/P8232150.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8232150/"},{filename: "Japan/P8232153.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8232153/"},{filename: "Japan/P8232222.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8232222/"},{filename: "Japan/P8232349.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8232349/"},{filename: "Japan/P8232374.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8232374/"},{filename: "Japan/P8232438.jpg", aspectRatio: 1.2598833441348023, url: "/img/albums/Japan/P8232438/"},{filename: "Japan/P8242474.jpg", aspectRatio: 1.2242811501597444, url: "/img/albums/Japan/P8242474/"},{filename: "Japan/P8242484.jpg", aspectRatio: 1.1807909604519775, url: "/img/albums/Japan/P8242484/"},{filename: "Japan/P8242499.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8242499/"},{filename: "Japan/P8242503.jpg", aspectRatio: 1.4705882352941178, url: "/img/albums/Japan/P8242503/"},{filename: "Japan/P8240105.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8240105/"},{filename: "Japan/P8240324.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8240324/"},{filename: "Japan/P8250666.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8250666/"},{filename: "Japan/P8250674.jpg", aspectRatio: 1.167186525265128, url: "/img/albums/Japan/P8250674/"},{filename: "Japan/P8250678.jpg", aspectRatio: 1.2855271774721677, url: "/img/albums/Japan/P8250678/"},{filename: "Japan/P8250872.jpg", aspectRatio: 1.2062182741116751, url: "/img/albums/Japan/P8250872/"},{filename: "Japan/P8250874.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8250874/"},{filename: "Japan/P8250879.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8250879/"},{filename: "Japan/P8250899.jpg", aspectRatio: 1.333555703802535, url: "/img/albums/Japan/P8250899/"},{filename: "Japan/P8250921.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8250921/"},{filename: "Japan/P8250953.jpg", aspectRatio: 0.9959654178674352, url: "/img/albums/Japan/P8250953/"},{filename: "Japan/P8250959.jpg", aspectRatio: 1.3519140362659503, url: "/img/albums/Japan/P8250959/"},{filename: "Japan/P8250960.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P8250960/"},{filename: "Japan/P8250987.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8250987/"},{filename: "Japan/P8250991.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8250991/"},{filename: "Japan/P8251020.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8251020/"},{filename: "Japan/P8251023.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8251023/"},{filename: "Japan/P8260006.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8260006/"},{filename: "Japan/P8260051.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8260051/"},{filename: "Japan/P8260118.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8260118/"},{filename: "Japan/P8260207.jpg", aspectRatio: 0.7003383276945384, url: "/img/albums/Japan/P8260207/"},{filename: "Japan/P8260208.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8260208/"},{filename: "Japan/P8260228.jpg", aspectRatio: 1.7868725868725868, url: "/img/albums/Japan/P8260228/"},{filename: "Japan/P8260261.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8260261/"},{filename: "Japan/P8260326.jpg", aspectRatio: 1.40218878248974, url: "/img/albums/Japan/P8260326/"},{filename: "Japan/P8260339.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8260339/"},{filename: "Japan/P8260340.jpg", aspectRatio: 1.6114369501466275, url: "/img/albums/Japan/P8260340/"},{filename: "Japan/P8260343.jpg", aspectRatio: 0.8661290322580645, url: "/img/albums/Japan/P8260343/"},{filename: "Japan/P8260393.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8260393/"},{filename: "Japan/P8260398.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8260398/"},{filename: "Japan/P8260441.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8260441/"},{filename: "Japan/P8260464.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8260464/"},{filename: "Japan/P8260471.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8260471/"},{filename: "Japan/P8260565.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8260565/"},{filename: "Japan/P8260567.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8260567/"},{filename: "Japan/P8260574.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8260574/"},{filename: "Japan/P8260620.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8260620/"},{filename: "Japan/P8260644.jpg", aspectRatio: 1.333555703802535, url: "/img/albums/Japan/P8260644/"},{filename: "Japan/P8260651.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8260651/"},{filename: "Japan/P8260653.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8260653/"},{filename: "Japan/P8260654.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8260654/"},{filename: "Japan/P8260689.jpg", aspectRatio: 1.33422281521014, url: "/img/albums/Japan/P8260689/"},{filename: "Japan/P8270051.jpg", aspectRatio: 1.988599348534202, url: "/img/albums/Japan/P8270051/"},{filename: "Japan/P8270058.jpg", aspectRatio: 1.4908321579689703, url: "/img/albums/Japan/P8270058/"},{filename: "Japan/P8270059.jpg", aspectRatio: 1.902788844621514, url: "/img/albums/Japan/P8270059/"},{filename: "Japan/P8270066.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P8270066/"},{filename: "Japan/P8270071.jpg", aspectRatio: 1.4806746310611385, url: "/img/albums/Japan/P8270071/"},{filename: "Japan/P8270072.jpg", aspectRatio: 1.3139072847682118, url: "/img/albums/Japan/P8270072/"},{filename: "Japan/P8270096.jpg", aspectRatio: 0.9828178694158075, url: "/img/albums/Japan/P8270096/"},{filename: "Japan/P8270097.jpg", aspectRatio: 1.3998632946001368, url: "/img/albums/Japan/P8270097/"},{filename: "Japan/P8270113.jpg", aspectRatio: 0.7502502502502503, url: "/img/albums/Japan/P8270113/"},{filename: "Japan/P8270114.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P8270114/"},{filename: "Japan/P8270117.jpg", aspectRatio: 1.0400707130229818, url: "/img/albums/Japan/P8270117/"},{filename: "Japan/P8270123.jpg", aspectRatio: 1.333555703802535, url: "/img/albums/Japan/P8270123/"},{filename: "Japan/P8270147.jpg", aspectRatio: 1.639792899408284, url: "/img/albums/Japan/P8270147/"},{filename: "Japan/P8270170.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P8270170/"},{filename: "Japan/P8270264.jpg", aspectRatio: 1.0, url: "/img/albums/Japan/P8270264/"},{filename: "Japan/P8270280.jpg", aspectRatio: 0.762481089258699, url: "/img/albums/Japan/P8270280/"},{filename: "Japan/P8270286.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8270286/"},{filename: "Japan/P8270287.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8270287/"},{filename: "Japan/P8270291.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8270291/"},{filename: "Japan/P8270294.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8270294/"},{filename: "Japan/P8270298.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8270298/"},{filename: "Japan/P8270319.jpg", aspectRatio: 1.33422281521014, url: "/img/albums/Japan/P8270319/"},{filename: "Japan/P8270323.jpg", aspectRatio: 1.7788906009244991, url: "/img/albums/Japan/P8270323/"},{filename: "Japan/P8270330.jpg", aspectRatio: 1.3442732752846618, url: "/img/albums/Japan/P8270330/"},{filename: "Japan/P8270346.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8270346/"},{filename: "Japan/P8270427.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8270427/"},{filename: "Japan/P8270433.jpg", aspectRatio: 1.0509177027827117, url: "/img/albums/Japan/P8270433/"},{filename: "Japan/P8270436.jpg", aspectRatio: 1.4434420541290771, url: "/img/albums/Japan/P8270436/"},{filename: "Japan/P8270439.jpg", aspectRatio: 1.0069565217391305, url: "/img/albums/Japan/P8270439/"},{filename: "Japan/P8270535.jpg", aspectRatio: 1.5231646471846043, url: "/img/albums/Japan/P8270535/"},{filename: "Japan/P8280182.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P8280182/"},{filename: "Japan/P8280184.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8280184/"},{filename: "Japan/P8280217.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8280217/"},{filename: "Japan/P8280226.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P8280226/"},{filename: "Japan/P8280264.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8280264/"},{filename: "Japan/P8280333.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8280333/"},{filename: "Japan/P8280356.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P8280356/"},{filename: "Japan/P8280415.jpg", aspectRatio: 1.2891803278688525, url: "/img/albums/Japan/P8280415/"},{filename: "Japan/P8280426.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8280426/"},{filename: "Japan/P8280427.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P8280427/"},{filename: "Japan/P8280432.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8280432/"},{filename: "Japan/P8280440.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P8280440/"},{filename: "Japan/P8280449.jpg", aspectRatio: 1.6995481927710843, url: "/img/albums/Japan/P8280449/"},{filename: "Japan/P8280455.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8280455/"},{filename: "Japan/P8280463.jpg", aspectRatio: 1.304749340369393, url: "/img/albums/Japan/P8280463/"},{filename: "Japan/P8280502.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P8280502/"},{filename: "Japan/P8280582.jpg", aspectRatio: 1.3989071038251366, url: "/img/albums/Japan/P8280582/"},{filename: "Japan/P8290612.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8290612/"},{filename: "Japan/P8290692.jpg", aspectRatio: 1.33422281521014, url: "/img/albums/Japan/P8290692/"},{filename: "Japan/P8290705.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8290705/"},{filename: "Japan/P8290728.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8290728/"},{filename: "Japan/P8290732.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8290732/"},{filename: "Japan/P8290783.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8290783/"},{filename: "Japan/P8290805.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8290805/"},{filename: "Japan/P8290837.jpg", aspectRatio: 0.7502502502502503, url: "/img/albums/Japan/P8290837/"},{filename: "Japan/P8290893.jpg", aspectRatio: 1.1432983323038912, url: "/img/albums/Japan/P8290893/"},{filename: "Japan/P8290901.jpg", aspectRatio: 1.2833769633507854, url: "/img/albums/Japan/P8290901/"},{filename: "Japan/P8290967.jpg", aspectRatio: 1.333555703802535, url: "/img/albums/Japan/P8290967/"},{filename: "Japan/P8290989.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8290989/"},{filename: "Japan/P8291015.jpg", aspectRatio: 0.9002739726027398, url: "/img/albums/Japan/P8291015/"},{filename: "Japan/P8291035.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8291035/"},{filename: "Japan/P8291051.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P8291051/"},{filename: "Japan/P8291077.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8291077/"},{filename: "Japan/P8291091.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8291091/"},{filename: "Japan/P8291105.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P8291105/"},{filename: "Japan/P8291106.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8291106/"},{filename: "Japan/P8291112.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P8291112/"},{filename: "Japan/P8291115.jpg", aspectRatio: 1.33422281521014, url: "/img/albums/Japan/P8291115/"},{filename: "Japan/P8291127.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8291127/"},{filename: "Japan/P8291162.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8291162/"},{filename: "Japan/P8291178.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P8291178/"},{filename: "Japan/P8291176.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P8291176/"},{filename: "Japan/P8291177.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P8291177/"},{filename: "Japan/P8291187.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P8291187/"},{filename: "Japan/P8291219.jpg", aspectRatio: 1.7788906009244991, url: "/img/albums/Japan/P8291219/"},{filename: "Japan/P8300011.jpg", aspectRatio: 2.6616399622997173, url: "/img/albums/Japan/P8300011/"},{filename: "Japan/P8310047.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8310047/"},{filename: "Japan/P8310060.jpg", aspectRatio: 1.7788906009244991, url: "/img/albums/Japan/P8310060/"},{filename: "Japan/P8310091.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P8310091/"},{filename: "Japan/P8310092.jpg", aspectRatio: 1.7788906009244991, url: "/img/albums/Japan/P8310092/"},{filename: "Japan/P8310108.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8310108/"},{filename: "Japan/P8310210.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8310210/"},{filename: "Japan/P8310218.jpg", aspectRatio: 1.333555703802535, url: "/img/albums/Japan/P8310218/"},{filename: "Japan/P8310224.jpg", aspectRatio: 1.3373413493653974, url: "/img/albums/Japan/P8310224/"},{filename: "Japan/P8310250.jpg", aspectRatio: 1.33422281521014, url: "/img/albums/Japan/P8310250/"},{filename: "Japan/P8310270.jpg", aspectRatio: 1.0, url: "/img/albums/Japan/P8310270/"},{filename: "Japan/P8310274.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P8310274/"},{filename: "Japan/P9010231.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9010231/"},{filename: "Japan/P9010238.jpg", aspectRatio: 1.4492350486787204, url: "/img/albums/Japan/P9010238/"},{filename: "Japan/P9010258.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9010258/"},{filename: "Japan/P9010330.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9010330/"},{filename: "Japan/P9010345.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9010345/"},{filename: "Japan/P9010346.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9010346/"},{filename: "Japan/P9010347.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9010347/"},{filename: "Japan/P9010364.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9010364/"},{filename: "Japan/P9010375.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9010375/"},{filename: "Japan/P9010377.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9010377/"},{filename: "Japan/P9010378.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9010378/"},{filename: "Japan/P9010399.jpg", aspectRatio: 1.1972187104930467, url: "/img/albums/Japan/P9010399/"},{filename: "Japan/P9010403.jpg", aspectRatio: 0.7503751875937968, url: "/img/albums/Japan/P9010403/"},{filename: "Japan/P9010410.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9010410/"},{filename: "Japan/P9010428.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P9010428/"},{filename: "Japan/P9010488.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P9010488/"},{filename: "Japan/P9010562.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9010562/"},{filename: "Japan/P9010565.jpg", aspectRatio: 2.519706691109074, url: "/img/albums/Japan/P9010565/"},{filename: "Japan/P9010587.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9010587/"},{filename: "Japan/P9010611.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P9010611/"},{filename: "Japan/P9010634.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9010634/"},{filename: "Japan/P9010698.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9010698/"},{filename: "Japan/P9010755.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9010755/"},{filename: "Japan/P9010796.jpg", aspectRatio: 1.0, url: "/img/albums/Japan/P9010796/"},{filename: "Japan/P9010812.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9010812/"},{filename: "Japan/P9010816.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9010816/"},{filename: "Japan/P9010818.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9010818/"},{filename: "Japan/P9020857.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9020857/"},{filename: "Japan/P9020902.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9020902/"},{filename: "Japan/P9020915.jpg", aspectRatio: 1.6114369501466275, url: "/img/albums/Japan/P9020915/"},{filename: "Japan/P9020010.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9020010/"},{filename: "Japan/P9030026.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P9030026/"},{filename: "Japan/P9030031.jpg", aspectRatio: 1.4757894736842105, url: "/img/albums/Japan/P9030031/"},{filename: "Japan/P9030053.jpg", aspectRatio: 1.0394581861012957, url: "/img/albums/Japan/P9030053/"},{filename: "Japan/P9030060.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9030060/"},{filename: "Japan/P9030066.jpg", aspectRatio: 1.2271273192578376, url: "/img/albums/Japan/P9030066/"},{filename: "Japan/P9030098.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P9030098/"},{filename: "Japan/P9030281.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9030281/"},{filename: "Japan/P9030294.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9030294/"},{filename: "Japan/P9030310.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9030310/"},{filename: "Japan/P9030311.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9030311/"},{filename: "Japan/P9040387.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9040387/"},{filename: "Japan/P9040391.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9040391/"},{filename: "Japan/P9040393.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9040393/"},{filename: "Japan/P9040400.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9040400/"},{filename: "Japan/P9040423.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9040423/"},{filename: "Japan/P9040447.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9040447/"},{filename: "Japan/P9040450.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9040450/"},{filename: "Japan/P9040457.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9040457/"},{filename: "Japan/P9040466.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9040466/"},{filename: "Japan/P9040555.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P9040555/"},{filename: "Japan/P9040561.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9040561/"},{filename: "Japan/P9040564.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P9040564/"},{filename: "Japan/P9050019.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9050019/"},{filename: "Japan/P9050042.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9050042/"},{filename: "Japan/P9050058.jpg", aspectRatio: 1.5873362445414847, url: "/img/albums/Japan/P9050058/"},{filename: "Japan/P9050089.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9050089/"},{filename: "Japan/P9050125.jpg", aspectRatio: 1.2096569250317661, url: "/img/albums/Japan/P9050125/"},{filename: "Japan/P9050157.jpg", aspectRatio: 1.8957836117740652, url: "/img/albums/Japan/P9050157/"},{filename: "Japan/P9050174.jpg", aspectRatio: 0.9839541547277937, url: "/img/albums/Japan/P9050174/"},{filename: "Japan/P9050192.jpg", aspectRatio: 1.1821608040201006, url: "/img/albums/Japan/P9050192/"},{filename: "Japan/P9050276.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9050276/"},{filename: "Japan/P9050337.jpg", aspectRatio: 1.0929951690821256, url: "/img/albums/Japan/P9050337/"},{filename: "Japan/P9050338.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9050338/"},{filename: "Japan/P9050379.jpg", aspectRatio: 1.5163584637268848, url: "/img/albums/Japan/P9050379/"},{filename: "Japan/P9050387.jpg", aspectRatio: 1.1321450522433927, url: "/img/albums/Japan/P9050387/"},{filename: "Japan/P9050392.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9050392/"},{filename: "Japan/P9050430.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9050430/"},{filename: "Japan/P9050431.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9050431/"},{filename: "Japan/P9050433.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9050433/"},{filename: "Japan/P9050475.jpg", aspectRatio: 0.7502502502502503, url: "/img/albums/Japan/P9050475/"},{filename: "Japan/P9050482.jpg", aspectRatio: 1.4968197879858658, url: "/img/albums/Japan/P9050482/"},{filename: "Japan/P9070510.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9070510/"},{filename: "Japan/P9070518.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9070518/"},{filename: "Japan/P9070530.jpg", aspectRatio: 1.5650289017341041, url: "/img/albums/Japan/P9070530/"},{filename: "Japan/P9070571.jpg", aspectRatio: 1.102486355366889, url: "/img/albums/Japan/P9070571/"},{filename: "Japan/P9070580.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9070580/"},{filename: "Japan/P9070585.jpg", aspectRatio: 1.33422281521014, url: "/img/albums/Japan/P9070585/"},{filename: "Japan/P9070588.jpg", aspectRatio: 1.8765822784810127, url: "/img/albums/Japan/P9070588/"},{filename: "Japan/P9080662.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9080662/"},{filename: "Japan/P9080693.jpg", aspectRatio: 2.037098103874691, url: "/img/albums/Japan/P9080693/"},{filename: "Japan/P9080714.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9080714/"},{filename: "Japan/P9080783.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P9080783/"},{filename: "Japan/P9080894.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9080894/"},{filename: "Japan/P9080963.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P9080963/"},{filename: "Japan/P9080985.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9080985/"},{filename: "Japan/P9080996.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9080996/"},{filename: "Japan/P9081042.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9081042/"},{filename: "Japan/P9081208.jpg", aspectRatio: 1.5138592750533049, url: "/img/albums/Japan/P9081208/"},{filename: "Japan/P9081213.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9081213/"},{filename: "Japan/P9081223.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9081223/"},{filename: "Japan/P9081306.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P9081306/"},{filename: "Japan/P9081355.jpg", aspectRatio: 1.4248275862068966, url: "/img/albums/Japan/P9081355/"},{filename: "Japan/P9091362.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9091362/"},{filename: "Japan/P9091364.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9091364/"},{filename: "Japan/P9091412.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9091412/"},{filename: "Japan/P9091420.jpg", aspectRatio: 0.75, url: "/img/albums/Japan/P9091420/"},{filename: "Japan/P9091435.jpg", aspectRatio: 1.33422281521014, url: "/img/albums/Japan/P9091435/"},{filename: "Japan/P9091446.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9091446/"},{filename: "Japan/P9091456.jpg", aspectRatio: 1.3333333333333333, url: "/img/albums/Japan/P9091456/"},];
                              var options = {
                                urlForSize: function(filename, size) {
                                  return '/img/' + size + '/' + filename;
                                },
                                figureTagName: "a",
                                transitionSpeed: 500,
                                getMinAspectRatio: function(lastWindowWidth) {
                                if (lastWindowWidth <= 640)  // Phones
                                  return 1;
                                else if (lastWindowWidth <= 1280)  // Tablets
                                  return 3;
                                else if (lastWindowWidth <= 1920)  // Laptops
                                  return 4;
                                return 5;  // Large desktops
                              },
                                spaceBetweenImages: 3,
                                getImageSize: function(lastWindowWidth) {
                                  return 250;
                                }
                                // ...
                              };
                          
                              var pig = new Pig(imageData, options).enable();
                            </script>]]></content><author><name>Sergio Basurco</name></author><category term="album" /><category term="photography" /><category term="japan" /><summary type="html"><![CDATA[I went to Japan last year. Precisely for this trip I bought a decent digital camera and started taking pictures as a hobby. I spent some time editing some of the photos, here’s a small selection of my favourites.]]></summary></entry><entry><title type="html">Photo geotagging using your Google location history</title><link href="https://chuckleplant.github.io/2018/07/23/google-photos-geotag.html" rel="alternate" type="text/html" title="Photo geotagging using your Google location history" /><published>2018-07-23T00:00:00+02:00</published><updated>2018-07-23T00:00:00+02:00</updated><id>https://chuckleplant.github.io/2018/07/23/google-photos-geotag</id><content type="html" xml:base="https://chuckleplant.github.io/2018/07/23/google-photos-geotag.html"><![CDATA[<blockquote>
  <p>He who controls the past controls the future. He who controls the present controls the past.</p>

  <p>– George Orwell, 1984</p>
</blockquote>

<p><a href="https://github.com/chuckleplant/blog/blob/master/scripts/location-geotag.py">Here</a>’s a script that runs on Python that can add GPS tags to your photos (jpg) given your Google location history. You have to download the location history from <a href="https://takeout.google.com/">https://takeout.google.com/</a> and run:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python location-geotag.py <span class="nt">--dir</span> <span class="o">{</span>your photos directory<span class="o">}</span> <span class="nt">--json</span> <span class="o">{</span>your location <span class="nb">history</span><span class="o">}</span>
</code></pre></div></div>

<p>Do <strong>backup</strong> your photos before doing this, you may lose them.</p>

<h2 id="somebodys-watching-me">Somebody’s watching me</h2>

<p>I use Google Photos for keeping the thousands if not hundreds of thousands of pictures I’ve taken over the years. Unlimited storage (I love unlimited stuff) for the price of image compression and probably Google using your photos for machine learning, ads and other orwellian ends.</p>

<div class="Container">
    <div class="Content">
<img class="imagedropshadow" src="/images/posts/geotag-gphotos.png" alt="Google Photos interface showing a map of where the photo was taken." />  
    </div>
</div>
<p><span class="caption" style="font-size: 80%"><i>Google Photos interface showing a map of where the photo was taken.</i></span></p>

<p>One feature I like is geotagging. Google Photos will use your location history to deduce where the photo was taken. Then they’ll show you a nice map when visiting the image and you’ll go <em>‘Oh look I’ve been there!’</em></p>

<p>However, I noticed that when exporting the photos out of Google, you don’t get the approximate geotag as metadata in your JPEG. This bothers me because the image gallery I’m using also shows you a small map if the image has GPS data in it (<a href="/2018/07/23/japan-trip.html">check it out!</a>).</p>

<p>After some research I found that it’s actually not possible to export the geotags from Google Photos. I did find that you can actually download your whole location history, all the location data Google has on you. It’s a lot of data depending on how long you’ve used a smartphone.</p>

<div class="Container">
    <div class="Content">
<img class="imagedropshadow" src="/images/posts/gdatum.png" alt="Get all the data Google has on you from [https://takeout.google.com/](https://takeout.google.com/). The list goes on and on." />  
    </div>
</div>
<p><span class="caption" style="font-size: 80%"><i>Get all the data Google has on you from <a href="https://takeout.google.com/">https://takeout.google.com/</a>. The list goes on and on.</i></span></p>

<p>So I made a small script that adds the GPS information on any photo using your location history as input. It’s quite simple but works surprisingly well.</p>

<h2 id="script">Script</h2>

<p>The script is written in Python. My location history was around 200Mb, so I wanted an efficient way to search through the whole file.</p>

<p>The Google export looks like this:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"locations"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"timestampMs"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1532122858202"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"latitudeE7"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">48445182</span><span class="p">,</span><span class="w">
    </span><span class="nl">"longitudeE7"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">24287419</span><span class="p">,</span><span class="w">
    </span><span class="nl">"accuracy"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">13</span><span class="p">,</span><span class="w">
    </span><span class="nl">"altitude"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">117</span><span class="p">,</span><span class="w">
    </span><span class="nl">"verticalAccuracy"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
  </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"timestampMs"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1532122465164"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"latitudeE7"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">439445411</span><span class="p">,</span><span class="w">
    </span><span class="nl">"longitudeE7"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">26287254</span><span class="p">,</span><span class="w">
    </span><span class="nl">"accuracy"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="p">,</span><span class="w">
    </span><span class="nl">"altitude"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">117</span><span class="p">,</span><span class="w">
    </span><span class="nl">"verticalAccuracy"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
  </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"timestampMs"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="s2">"1532122068529"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"latitudeE7"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">419945411</span><span class="p">,</span><span class="w">
    </span><span class="nl">"longitudeE7"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">12287254</span><span class="p">,</span><span class="w">
    </span><span class="nl">"accuracy"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="p">,</span><span class="w">
    </span><span class="nl">"altitude"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">117</span><span class="p">,</span><span class="w">
    </span><span class="nl">"verticalAccuracy"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="w">
  </span><span class="p">}]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>I loaded the JSON and created a custom <code class="language-plaintext highlighter-rouge">Location</code> class which just registered the GPS info and the timestamp. I converted the timestamps to seconds when loading them. I also defined some operators to be able to sort and search the locations list.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#
# Note I construct directly from the JSON dictionary
#
</span><span class="k">class</span> <span class="nc">Location</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">d</span><span class="o">=</span><span class="p">{}):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">latitude</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">longitude</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">altitude</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="s">'timestampMs'</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">timestamp</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">])</span> <span class="o">/</span> <span class="mi">1000</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s">'latitudeE7'</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">latitude</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s">'longitudeE7'</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">longitude</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">key</span> <span class="o">==</span> <span class="s">'altitude'</span><span class="p">:</span>
                <span class="bp">self</span><span class="p">.</span><span class="n">altitude</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">timestamp</span> <span class="o">==</span> <span class="n">other</span><span class="p">.</span><span class="n">timestamp</span>
    <span class="k">def</span> <span class="nf">__lt__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">timestamp</span> <span class="o">&lt;</span> <span class="n">other</span><span class="p">.</span><span class="n">timestamp</span>
    <span class="k">def</span> <span class="nf">__le__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">timestamp</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="p">.</span><span class="n">timestamp</span>
    <span class="k">def</span> <span class="nf">__gt__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">timestamp</span> <span class="o">&gt;</span> <span class="n">other</span><span class="p">.</span><span class="n">timestamp</span>
    <span class="k">def</span> <span class="nf">__ge__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">timestamp</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="p">.</span><span class="n">timestamp</span>
    <span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> <span class="n">other</span> <span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">timestamp</span> <span class="o">!=</span> <span class="n">other</span><span class="p">.</span><span class="n">timestamp</span>
</code></pre></div></div>

<p>Using the <a href="https://docs.python.org/2/library/bisect.html">bisect</a> python module I could have \(O(\log{}n)\) search times, which is as good as I can hope for. I had to reverse the locations because Google exports them in descending timestamp order.</p>

<p>I got the timestamp from my images using PIL black magic <code class="language-plaintext highlighter-rouge">image._getexif()[36867]</code>. And then it was a matter of finding the location with the closest timestamp to my image. From <a href="https://stackoverflow.com/a/12141511/2628257">SO</a>:</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">find_closest_in_time</span><span class="p">(</span><span class="n">locations</span><span class="p">,</span> <span class="n">a_location</span><span class="p">):</span>
    <span class="n">pos</span> <span class="o">=</span> <span class="n">bisect_left</span><span class="p">(</span><span class="n">locations</span><span class="p">,</span> <span class="n">a_location</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">locations</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">pos</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">locations</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">locations</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    
    <span class="n">before</span> <span class="o">=</span> <span class="n">locations</span><span class="p">[</span><span class="n">pos</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">after</span> <span class="o">=</span> <span class="n">locations</span><span class="p">[</span><span class="n">pos</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">after</span><span class="p">.</span><span class="n">timestamp</span> <span class="o">-</span> <span class="n">a_location</span><span class="p">.</span><span class="n">timestamp</span> <span class="o">&lt;</span> <span class="n">a_location</span><span class="p">.</span><span class="n">timestamp</span> <span class="o">-</span> <span class="n">before</span><span class="p">.</span><span class="n">timestamp</span><span class="p">:</span>
       <span class="k">return</span> <span class="n">after</span>
    <span class="k">else</span><span class="p">:</span>
       <span class="k">return</span> <span class="n">before</span>
</code></pre></div></div>

<p>In order to add the GPS information I used the <a href="https://github.com/bennoleslie/pexif">pexif</a> module at first. But I found that the Exif data written by the module was sometimes broken. I switched to <a href="https://pypi.org/project/piexif/">piexif</a>, which does basically the same. The documentation however was a bit harder to bite, luckily I found <a href="https://gist.github.com/c060604/8a51f8999be12fc2be498e9ca56adc72">this gist</a> that showed how to embed GPS data via exif.</p>

<p>I also added a time threshold of a couple of hours, any location out of that threshold would be considered inaccurate.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#
# piexif library usage to add GPS info to an image
#
</span><span class="n">approx_location</span> <span class="o">=</span> <span class="n">find_closest_in_time</span><span class="p">(</span><span class="n">my_locations</span><span class="p">,</span> <span class="n">curr_loc</span><span class="p">)</span>
<span class="n">hours_away</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">approx_location</span><span class="p">.</span><span class="n">timestamp</span> <span class="o">-</span> <span class="n">time_jpeg_unix</span><span class="p">)</span> <span class="o">/</span> <span class="mi">3600</span>

<span class="k">if</span><span class="p">(</span><span class="n">hours_away</span> <span class="o">&lt;</span> <span class="n">hours_threshold</span><span class="p">):</span>
    <span class="c1"># Google stores these as x-e7
</span>    <span class="n">lat_f</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">approx_location</span><span class="p">.</span><span class="n">latitude</span><span class="p">)</span> <span class="o">/</span> <span class="mf">10000000.0</span>
    <span class="n">lon_f</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">approx_location</span><span class="p">.</span><span class="n">longitude</span><span class="p">)</span> <span class="o">/</span> <span class="mf">10000000.0</span>
    
    <span class="n">exif_dict</span> <span class="o">=</span> <span class="n">piexif</span><span class="p">.</span><span class="n">load</span><span class="p">(</span><span class="n">image_file</span><span class="p">)</span>        
    <span class="n">exif_dict</span><span class="p">[</span><span class="s">"GPS"</span><span class="p">][</span><span class="n">piexif</span><span class="p">.</span><span class="n">GPSIFD</span><span class="p">.</span><span class="n">GPSVersionID</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">exif_dict</span><span class="p">[</span><span class="s">"GPS"</span><span class="p">][</span><span class="n">piexif</span><span class="p">.</span><span class="n">GPSIFD</span><span class="p">.</span><span class="n">GPSAltitudeRef</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="k">if</span> <span class="n">approx_location</span><span class="p">.</span><span class="n">altitude</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="mi">1</span>        
    <span class="n">exif_dict</span><span class="p">[</span><span class="s">"GPS"</span><span class="p">][</span><span class="n">piexif</span><span class="p">.</span><span class="n">GPSIFD</span><span class="p">.</span><span class="n">GPSAltitude</span><span class="p">]</span> <span class="o">=</span> <span class="n">change_to_rational</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">approx_location</span><span class="p">.</span><span class="n">altitude</span><span class="p">))</span>
    <span class="n">exif_dict</span><span class="p">[</span><span class="s">"GPS"</span><span class="p">][</span><span class="n">piexif</span><span class="p">.</span><span class="n">GPSIFD</span><span class="p">.</span><span class="n">GPSLatitudeRef</span><span class="p">]</span> <span class="o">=</span> <span class="s">'S'</span> <span class="k">if</span> <span class="n">lat_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s">'N'</span>
    <span class="n">exif_dict</span><span class="p">[</span><span class="s">"GPS"</span><span class="p">][</span><span class="n">piexif</span><span class="p">.</span><span class="n">GPSIFD</span><span class="p">.</span><span class="n">GPSLongitudeRef</span><span class="p">]</span> <span class="o">=</span> <span class="s">'W'</span> <span class="k">if</span> <span class="n">lon_f</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s">'E'</span>

    <span class="n">lat_deg</span> <span class="o">=</span> <span class="n">to_deg</span><span class="p">(</span><span class="n">lat_f</span><span class="p">,</span> <span class="p">[</span><span class="s">"S"</span><span class="p">,</span> <span class="s">"N"</span><span class="p">])</span>
    <span class="n">lng_deg</span> <span class="o">=</span> <span class="n">to_deg</span><span class="p">(</span><span class="n">lon_f</span><span class="p">,</span> <span class="p">[</span><span class="s">"W"</span><span class="p">,</span> <span class="s">"E"</span><span class="p">])</span>
    <span class="n">exiv_lat</span> <span class="o">=</span> <span class="p">(</span><span class="n">change_to_rational</span><span class="p">(</span><span class="n">lat_deg</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">change_to_rational</span><span class="p">(</span><span class="n">lat_deg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">change_to_rational</span><span class="p">(</span><span class="n">lat_deg</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
    <span class="n">exiv_lng</span> <span class="o">=</span> <span class="p">(</span><span class="n">change_to_rational</span><span class="p">(</span><span class="n">lng_deg</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">change_to_rational</span><span class="p">(</span><span class="n">lng_deg</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="n">change_to_rational</span><span class="p">(</span><span class="n">lng_deg</span><span class="p">[</span><span class="mi">2</span><span class="p">]))</span>
    <span class="n">exif_dict</span><span class="p">[</span><span class="s">"GPS"</span><span class="p">][</span><span class="n">piexif</span><span class="p">.</span><span class="n">GPSIFD</span><span class="p">.</span><span class="n">GPSLatitude</span><span class="p">]</span> <span class="o">=</span> <span class="n">exiv_lat</span>
    <span class="n">exif_dict</span><span class="p">[</span><span class="s">"GPS"</span><span class="p">][</span><span class="n">piexif</span><span class="p">.</span><span class="n">GPSIFD</span><span class="p">.</span><span class="n">GPSLongitude</span><span class="p">]</span> <span class="o">=</span> <span class="n">exiv_lng</span>
    
    <span class="n">exif_bytes</span> <span class="o">=</span> <span class="n">piexif</span><span class="p">.</span><span class="n">dump</span><span class="p">(</span><span class="n">exif_dict</span><span class="p">)</span>
    <span class="n">image</span><span class="p">.</span><span class="n">save</span><span class="p">(</span><span class="n">image_file</span><span class="p">,</span> <span class="n">exif</span><span class="o">=</span><span class="n">exif_bytes</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="k">print</span> <span class="s">'Time threshold surpassed'</span>
</code></pre></div></div>

<p>The full script can be found <a href="https://github.com/chuckleplant/blog/blob/master/scripts/location-geotag.py">here</a>. Make sure to make a backup of your images before running the script!</p>]]></content><author><name>Sergio Basurco</name></author><category term="google" /><category term="gps" /><category term="geotag" /><category term="python" /><category term="exif" /><category term="jpeg" /><category term="creepy" /><category term="photography" /><summary type="html"><![CDATA[He who controls the past controls the future. He who controls the present controls the past. – George Orwell, 1984]]></summary></entry><entry><title type="html">Uncharted 4: A Thief’s End</title><link href="https://chuckleplant.github.io/2018/07/15/uncharted-4.html" rel="alternate" type="text/html" title="Uncharted 4: A Thief’s End" /><published>2018-07-15T00:00:00+02:00</published><updated>2018-07-15T00:00:00+02:00</updated><id>https://chuckleplant.github.io/2018/07/15/uncharted-4</id><content type="html" xml:base="https://chuckleplant.github.io/2018/07/15/uncharted-4.html"><![CDATA[<blockquote>
  <p>Spoiler alert: The images below may ruin your game experience.</p>
</blockquote>

<p>I hated how much I loved the photography feature in Uncharted 4. The problem is that I spent way more time taking pictures than actually playing the game. Jokes aside, I think it’s an actual problem and game designers should look into it. I think the new God of War does also have a photo mode. I think you can either play or take pictures, not both. It’s a bit like recording fireworks with your phone, just don’t.</p>

<p>Maybe the mode could be unlocked once you complete the game for the first time. Of course there are many players that play only once… And the feature is great for sharing and marketing. Anyways, those are my 2cts on the topic.</p>

<p>I am launching a brand new image gallery. I used aerobless’ <a href="https://github.com/aerobless/jekyll-photo-gallery">Jekyll photo gallery</a>. It lets you have a static site for each image which is nice for comments or sharing.</p>

<p>Here’s a selection of some of the pictures I took while playing Uncherted 4: A Thief’s End. I really enjoyed creating false narratives with each picture, specially when characters were facing each other, or capturing a secondary character making it look like there was a story behind them.</p>

<div id="pig"></div>
<script src="/js/plugins/pig/src/pig.min.js"></script>
<script>
                              var imageData = [{filename: "Uncharted/Deep stare.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Deep-stare/"},{filename: "Uncharted/No you didn't.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/No-you-didnt/"},{filename: "Uncharted/Lamp.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Lamp/"},{filename: "Uncharted/Lemon dream.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Lemon-dream/"},{filename: "Uncharted/Hallway light.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Hallway-light/"},{filename: "Uncharted/Fulfilled.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Fulfilled/"},{filename: "Uncharted/Lighter.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Lighter/"},{filename: "Uncharted/Sunset arc.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Sunset-arc/"},{filename: "Uncharted/A little dance.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/A-little-dance/"},{filename: "Uncharted/Dry structure.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Dry-structure/"},{filename: "Uncharted/Mist and weed.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Mist-and-weed/"},{filename: "Uncharted/Chilly.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Chilly/"},{filename: "Uncharted/I wanted the walky.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/I-wanted-the-walky/"},{filename: "Uncharted/Long fall.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Long-fall/"},{filename: "Uncharted/Fresh 90's album.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Fresh-90s-album/"},{filename: "Uncharted/Within trees.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Within-trees/"},{filename: "Uncharted/Blinded again.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Blinded-again/"},{filename: "Uncharted/Pupil.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Pupil/"},{filename: "Uncharted/Flick these.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Flick-these/"},{filename: "Uncharted/What's that smell.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Whats-that-smell/"},{filename: "Uncharted/It wasn't me.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/It-wasnt-me/"},{filename: "Uncharted/Orange rectangle.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Orange-rectangle/"},{filename: "Uncharted/Comic jump.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Comic-jump/"},{filename: "Uncharted/Cave arc.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Cave-arc/"},{filename: "Uncharted/Grainy mountain.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Grainy-mountain/"},{filename: "Uncharted/Shower.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Shower/"},{filename: "Uncharted/Who's doing this.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Whos-doing-this/"},{filename: "Uncharted/Sorry mate.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Sorry-mate/"},{filename: "Uncharted/National geographic.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/National-geographic/"},{filename: "Uncharted/Tree between bricks.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Tree-between-bricks/"},{filename: "Uncharted/Zenit jump.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Zenit-jump/"},{filename: "Uncharted/Tombstones.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Tombstones/"},{filename: "Uncharted/Three friends.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Three-friends/"},{filename: "Uncharted/Cross in field.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Cross-in-field/"},{filename: "Uncharted/Arcway.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Arcway/"},{filename: "Uncharted/Soft light.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Soft-light/"},{filename: "Uncharted/Romantic comedy shot.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Romantic-comedy-shot/"},{filename: "Uncharted/Bourne shot.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Bourne-shot/"},{filename: "Uncharted/Don't throw me fruit.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Dont-throw-me-fruit/"},{filename: "Uncharted/Moist.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Moist/"},{filename: "Uncharted/Guybrush.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Guybrush/"},{filename: "Uncharted/Light through water.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Light-through-water/"},{filename: "Uncharted/Underwater arc.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Underwater-arc/"},{filename: "Uncharted/Nate swimming.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Nate-swimming/"},{filename: "Uncharted/Duel shot.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Duel-shot/"},{filename: "Uncharted/Contrasty rock.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Contrasty-rock/"},{filename: "Uncharted/Jungle arc.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Jungle-arc/"},{filename: "Uncharted/An eye.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/An-eye/"},{filename: "Uncharted/Cave frame.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Cave-frame/"},{filename: "Uncharted/Blue postcard.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Blue-postcard/"},{filename: "Uncharted/Rock.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Rock/"},{filename: "Uncharted/Flowers under arc.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Flowers-under-arc/"},{filename: "Uncharted/I love arcs.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/I-love-arcs/"},{filename: "Uncharted/Cinematic dialogue Nate.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Cinematic-dialogue-Nate/"},{filename: "Uncharted/Cinematic Samuel.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Cinematic-Samuel/"},{filename: "Uncharted/Do you even swim.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Do-you-even-swim/"},{filename: "Uncharted/Guybrush Threepstone.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Guybrush-Threepstone/"},{filename: "Uncharted/Stormy weather.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Stormy-weather/"},{filename: "Uncharted/Sepia or cloudy sunset.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Sepia-or-cloudy-sunset/"},{filename: "Uncharted/Plant over hole.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Plant-over-hole/"},{filename: "Uncharted/Wet and red.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Wet-and-red/"},{filename: "Uncharted/Windy rain.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Windy-rain/"},{filename: "Uncharted/The bear.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/The-bear/"},{filename: "Uncharted/Humid landscape and scary rock.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Humid-landscape-and-scary-rock/"},{filename: "Uncharted/Corridor.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Corridor/"},{filename: "Uncharted/Nature finds a way.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Nature-finds-a-way/"},{filename: "Uncharted/Mugs with secrets.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Mugs-with-secrets/"},{filename: "Uncharted/Once cozy always cozy.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Once-cozy-always-cozy/"},{filename: "Uncharted/Old patio.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Old-patio/"},{filename: "Uncharted/Light facing dark.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Light-facing-dark/"},{filename: "Uncharted/Defaced library.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Defaced-library/"},{filename: "Uncharted/Him again.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Him-again/"},{filename: "Uncharted/Moonlight.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Moonlight/"},{filename: "Uncharted/Blinded.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Blinded/"},{filename: "Uncharted/Big helmet.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Big-helmet/"},{filename: "Uncharted/The smallest island.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/The-smallest-island/"},{filename: "Uncharted/Hanging out.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Hanging-out/"},{filename: "Uncharted/Crows.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Crows/"},{filename: "Uncharted/So many coins here.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/So-many-coins-here/"},{filename: "Uncharted/Just sneezed.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Just-sneezed/"},{filename: "Uncharted/Flower carpet.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Flower-carpet/"},{filename: "Uncharted/Statue.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Statue/"},{filename: "Uncharted/Torch.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Torch/"},{filename: "Uncharted/Pierced eardrums.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Pierced-eardrums/"},{filename: "Uncharted/Reading hieroglyphs.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Reading-hieroglyphs/"},{filename: "Uncharted/Heard something.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Heard-something/"},{filename: "Uncharted/Stupid Goonies.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Stupid-Goonies/"},{filename: "Uncharted/Please put that out.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Please-put-that-out/"},{filename: "Uncharted/Red flags.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Red-flags/"},{filename: "Uncharted/Shipwreck dusk.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Shipwreck-dusk/"},{filename: "Uncharted/Patio guardian.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Patio-guardian/"},{filename: "Uncharted/Catching some air.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Catching-some-air/"},{filename: "Uncharted/Doesn't get much cozier.jpg", aspectRatio: 1.7777777777777777, url: "/img/albums/Uncharted/Doesnt-get-much-cozier/"},];
                              var options = {
                                urlForSize: function(filename, size) {
                                  return '/img/' + size + '/' + filename;
                                },
                                figureTagName: "a",
                                transitionSpeed: 500,
                                getMinAspectRatio: function(lastWindowWidth) {
                                if (lastWindowWidth <= 640)  // Phones
                                  return 1;
                                else if (lastWindowWidth <= 1280)  // Tablets
                                  return 3;
                                else if (lastWindowWidth <= 1920)  // Laptops
                                  return 4;
                                return 5;  // Large desktops
                              },
                                spaceBetweenImages: 3,
                                getImageSize: function(lastWindowWidth) {
                                  return 250;
                                }
                                // ...
                              };
                          
                              var pig = new Pig(imageData, options).enable();
                            </script>]]></content><author><name>Sergio Basurco</name></author><category term="uncharted" /><category term="games" /><category term="album" /><summary type="html"><![CDATA[Spoiler alert: The images below may ruin your game experience.]]></summary></entry><entry><title type="html">Isaac Hayes Wallpaper Generator - Volumetric light scattering, 2 of 2</title><link href="https://chuckleplant.github.io/2017/12/04/light-shafts-pt-2.html" rel="alternate" type="text/html" title="Isaac Hayes Wallpaper Generator - Volumetric light scattering, 2 of 2" /><published>2017-12-04T00:00:00+01:00</published><updated>2017-12-04T00:00:00+01:00</updated><id>https://chuckleplant.github.io/2017/12/04/light-shafts-pt-2</id><content type="html" xml:base="https://chuckleplant.github.io/2017/12/04/light-shafts-pt-2.html"><![CDATA[<blockquote>
  <p>Continuation of <a href="/2017/05/28/light-shafts.html">Isaac Hayes Wallpaper Generator - Volumetric light scattering, 1 of 2</a></p>

  <p>You can go straight to the <a href="/emscripten/isaac_hayes_wg/IsaacWallpaper.html">Wallpaper Generator</a> tool (works best with chrome last I tested)</p>
</blockquote>

<p>Now that covered the basics of light rendering and volumetric light scattering, let’s see how we don’t do any of that and instead cheat to get an approximated result.</p>

<p>A bit like in impressionism, we don’t try to match physical light behaviour objectively, but to emulate what we see in an efficient way. That’s computer graphics in a nutshell.</p>

<h2 id="formulae-summary">Formulae summary</h2>

<p>Rendring equation:</p>

\[{L_{\text{o}}(\mathbf x,\, \omega_{\text{o}})} {\,=\,} {L_e(\mathbf x,\, \omega_{\text{o}})}  {\ +\,}  {\int_\Omega}  {f_r(\mathbf x,\, \omega_{\text{i}},\, \omega_{\text{o}})\,}  {L_{\text{i}}(\mathbf x,\, \omega_{\text{i}})\,}  {(\omega_{\text{i}}\,\cdot\,\mathbf n)\,}  {\operatorname d \omega_{\text{i}}}\]

<p>Light intensity and extinction constant:</p>

\[I=I_\text{o} · e^{-\tau s}\]

<p>Light scattering equation:</p>

\[{L(s,\,\theta)}  {\,=\,}  {L_\text{o}}  {e^{-\tau s}}  {\,+\,} \frac{1}{\tau}  {\,E_{sun}}  {\,S(\theta)}  {(1 \,-\, }  {e^{-\tau s}} {)}\]

<p>Occlusion:</p>

\[L(s,\,\theta,\,\phi) = (1 \,-\, D(\phi)) \,L(s,\,\theta)\]

<h2 id="accounting-for-occlusion">Accounting for occlusion</h2>

<p>We need to account for all objects occluding each beam of light. For this rendering solution we use only screen space information, so we don’t have any 3D information and cannot compute for each ray whether it was occluded or not. Also keep in mind, that each pixel on screen represents us, the viewer.</p>

<p>Eq. 3 computes, for a whole ray, the accumulated light value based on the media it traverses. What we’ll do is march on screen space, accumulating by sampling along the ray’s path towards any given pixel.</p>

<div class="Container">
    <div class="Content">
<img class="imagedropshadow" src="/images/cheating-shaft.png" alt="Each dot represents a sample, we omit the samples that have an occluder. This makes the pixels with no ocluders (on screen space) be brighter." />  
    </div>
</div>
<p><span class="caption" style="font-size: 80%"><i>Each dot represents a sample, we omit the samples that have an occluder. This makes the pixels with no ocluders (on screen space) be brighter.</i></span></p>

<h2 id="the-sum">The sum</h2>

<p>We want to compute the light at a given <em>fragment</em> (each small square in the image above), we will sum the energy values sampled along the ray from the light source towards our pixel. We will:</p>

\[L(p) = \sum_{i=0}^n decay^i \times weight \times \frac{L(s,\theta)}{n}\]

<p>The \(decay\) term is a falloff, that attenuates the energy based on the distance to the light source. The \(weight\) is the shaft’s intensity<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup>.</p>

<p>The further the pixel is from the light source, the dimmer light accumulation is.</p>

<div class="Container">
    <div class="Content">
<img class="imagedropshadow" src="/images/red-dead-blackness.png" alt="In our first render pass we render just the scene in black and the light source. Note that we paint the sun red in this case so that the light shifts from white at maximum intensity to a dim red (What I like to call dead red)." />  
    </div>
</div>
<p><span class="caption" style="font-size: 80%"><i>In our first render pass we render just the scene in black and the light source. Note that we paint the sun red in this case so that the light shifts from white at maximum intensity to a dim red (What I like to call dead red).</i></span></p>

<div class="Container">
    <div class="Content">
<img class="imagedropshadow" src="/images/red-dead-scene.png" alt="Our second render pass draws the scene as we want it, in this case just a silhouette with the sun behind it. Note that we draw the sun as a white circle too without the shafts." />  
    </div>
</div>
<p><span class="caption" style="font-size: 80%"><i>Our second render pass draws the scene as we want it, in this case just a silhouette with the sun behind it. Note that we draw the sun as a white circle too without the shafts.</i></span></p>

<div class="Container">
    <div class="Content">
<img class="imagedropshadow" src="/images/red-dead-shaft.png" alt="Last we run a final pass that samples for each fragment the brightness energy in the direction of the light source. This results in the shafts of light passing through the occluders." />  
    </div>
</div>
<p><span class="caption" style="font-size: 80%"><i>Last we run a final pass that samples for each fragment the brightness energy in the direction of the light source. This results in the shafts of light passing through the occluders.</i></span></p>

<h1 id="application-in-games">Application in games</h1>

<p>It is based on physical effects, but is not by any means physically realistic. The effect is only valid when the light in screen space. The effect disappears completely when the light is either out of view or completely occluded.</p>

<p>But, should games aim for physical realism? I don’t think so. As a means to transmitting emotions to the player, game developers should use any possible trick to do so, visual illusions such as this rather simplistic radial blur are very effective.</p>

<h1 id="isaac-hayes-wallpaper-generator">Isaac Hayes Wallpaper Generator</h1>

<video autoplay="autoplay" loop="loop" width="100%">
    <source src="/videos/rdrgif.mp4" type="video/mp4" />
</video>

<p>Whithout further ado I present the <a href="/emscripten/isaac_hayes_wg/IsaacWallpaper.html">Isaac Hayes Wallpaper Generator</a><sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup>. You can tweak light intensity, background color. You can also upload your own image (with transparency) to play with it and pierce your own eyes with the power of the sun, or not, your call.<sup id="fnref:3" role="doc-noteref"><a href="#fn:3" class="footnote" rel="footnote">3</a></sup>\(^,\)<sup id="fnref:4" role="doc-noteref"><a href="#fn:4" class="footnote" rel="footnote">4</a></sup></p>

<p>It was also an experiment using Emscripten to port C++ code to JavaScript, the toughest was loading files from disk and saving them back. Apparently browsers are not cool with you merrily accessing the file system!</p>

<p>Find all the relevant in the github <a href="https://github.com/chuckleplant/IsaacHayesWG">repository</a>.</p>

<hr />

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p>Note that we’ve dropped the exposure term use in Nvidia’s formulation, it just provides more granularity on the \(weight\) term. <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2" role="doc-endnote">
      <p><a href="https://www.youtube.com/watch?v=nFvRvSxsW-I">Recommended soundtrack</a> <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:3" role="doc-endnote">
      <p><a href="https://github.com/openframeworks/openFrameworks">Coded using openFrameworks.</a> <a href="#fnref:3" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:4" role="doc-endnote">
      <p><a href="https://medium.com/community-play-3d/god-rays-whats-that-5a67f26aeac2">Based on Julien Moreau-Mathis: God Rays? What’s that?</a> <a href="#fnref:4" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>]]></content><author><name>Sergio Basurco</name></author><summary type="html"><![CDATA[Continuation of Isaac Hayes Wallpaper Generator - Volumetric light scattering, 1 of 2 You can go straight to the Wallpaper Generator tool (works best with chrome last I tested)]]></summary></entry><entry><title type="html">Isaac Hayes Wallpaper Generator - Volumetric light scattering, 1 of 2</title><link href="https://chuckleplant.github.io/2017/05/28/light-shafts.html" rel="alternate" type="text/html" title="Isaac Hayes Wallpaper Generator - Volumetric light scattering, 1 of 2" /><published>2017-05-28T00:00:00+02:00</published><updated>2017-05-28T00:00:00+02:00</updated><id>https://chuckleplant.github.io/2017/05/28/light-shafts</id><content type="html" xml:base="https://chuckleplant.github.io/2017/05/28/light-shafts.html"><![CDATA[<blockquote>
  <p>This post is greatly based on the <a href="https://developer.nvidia.com/gpugems/GPUGems3/gpugems3_ch13.html">Nvidia GPU Gem on volumetric light scattering</a>. Here I walk you through the formulae and core concepts. I highly recommend reading that one instead, and come back only if you couldn’t follow, or for fun.</p>

  <p>If you’re unfamiliar with computer graphics, I highly recommend you to watch <a href="https://youtu.be/IyUgHPs86XM">John Carmack’s talk on lighting and rendering</a>.</p>
</blockquote>

<div class="Container">
    <div class="Content">
<img class="imagedropshadow" src="/images/red-dead-shaft.png" alt="Light shafts sample image, generated with the *Isaac Hayes Wallpaper Generator* tool, available in the second part of this entry. The image is from Rockstar's Red Dead Redemption 2 concept art." />  
    </div>
</div>
<p><span class="caption" style="font-size: 80%"><i>Light shafts sample image, generated with the <em>Isaac Hayes Wallpaper Generator</em> tool, available in the second part of this entry. The image is from Rockstar’s Red Dead Redemption 2 concept art.</i></span></p>

<p>Often there’s one rendering effect that has me in awe everytime I see it. The first one I remember was normal mapping. While playing videogames I used to walk towards a wall that had a light bulb nearby, and then I spent a good 10 minutes just moving near the wall, seeing how the light behaved.</p>

<p>Lately I found myself doing the same thing while playing The Witcher 3, I just forwarded time until the sun was low enough so I could just toy with the light shaft effects between the trees. And then again, I spend a shameful amount of time just walking back and forth seeing how these patterns would unfold.</p>

<p>For the sake of me actually playing videogames instead of just being mesmerized by technical feats, I decided to understand how light shafts are generated and what’s the theory behind it.</p>

<p>My hope here is to give any reader a shallow but thorough overview of computer graphics rendering and physically based rendering effects. These two concepts are rather tangent, in the sense that computer graphics will not use the actual physical formulae, but hacky approximations.</p>

<h2 id="rendering-equation-review">Rendering equation review</h2>

<p><img src="/images/rendering-equation-drawing.png" alt="renderineq" /></p>

\[\definecolor{steadyblue}{RGB}{0,76,212} %004CD4
\definecolor{lobster}{RGB}{185,138,162} %B98AA2
\definecolor{mars}{RGB}{255,165,44} %FFA52C
\definecolor{rosamund}{RGB}{198,73,255} %C649FF
\definecolor{gold}{RGB}{255,206,63} %FFCE3F
\definecolor{bleu}{RGB}{73,214,255} %49D6FF
\definecolor{pistacho}{RGB}{118,163,39} %76A327
\definecolor{sea}{RGB}{41,153,124}  %29997C 
\definecolor{flower}{RGB}{255,85,149} %FF5595

\color{steadyblue}{L_{\text{o}}(\mathbf x,\, \omega_{\text{o}})} \color{black}{\,=\,} \color{mars}{L_e(\mathbf x,\, \omega_{\text{o}})} \color{black}{\ +\,} \color{bleu}{\int_\Omega} \color{flower}{f_r(\mathbf x,\, \omega_{\text{i}},\, \omega_{\text{o}})\,} \color{rosamund}{L_{\text{i}}(\mathbf x,\, \omega_{\text{i}})\,} \color{pistacho}{(\omega_{\text{i}}\,\cdot\,\mathbf n)\,} \color{bleu}{\operatorname d \omega_{\text{i}}}\]

<p>To find <font color="#004CD4">the light towards the viewer from a specific point</font>, we sum the <font color="#FFA52C">light emitted from such point</font> plus <font color="#49D6FF">the integral within the unit hemisphere</font> of <font color="#C649FF">the light coming from a any given direction</font> multiplied by the <font color="#FF5595">chances of such light rays bouncing towards the viewer</font><sup id="fnref:100" role="doc-noteref"><a href="#fn:100" class="footnote" rel="footnote">1</a></sup> and also by <font color="#76A327">the irradiance factor over the normal at the point</font>.<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">2</a></sup>\(^,\)<sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">3</a></sup></p>

<p>Note that <font color="C649FF">incoming light</font> is also computed by that very formula, which makes this exhaustingly recursive.</p>

<p>So, think about the pixel you’re reading right now, your screen is probably emitting more light than it transmits from other sources, if you have a glossy screen, then you see your own reflection. Meaning that for every point in your screen, light is reflected along the surface normal (perpendicular to your screen) in a <strong>specular</strong> fashion.</p>

<p>If you have a non-glossy screen, then the light bouncing from other light sources is more evenly distributed over the reflection hemisphere, hence not forming a clear image as a result, but a <strong>diffuse</strong> image instead.</p>

<h2 id="volumetric-light-scattering-equations">Volumetric light scattering equations</h2>

<p>Light, as the electromagnetic radiation it is, interacts with matter mainly in two ways<sup id="fnref:4" role="doc-noteref"><a href="#fn:4" class="footnote" rel="footnote">4</a></sup>:</p>

<ul>
  <li>Absorption (The photons disappear)</li>
  <li>Scattering (The photons change their direction)</li>
</ul>

<p>In both cases the <strong>transmitted intensity</strong> \(I\) decreases exponentially. Being \(\tau\) the extinction coefficient composed of light absortion and out-scattering, and \(s\) the thickness of the medium we traverse, we use an exponential function over \(e\) to represent the extinction coefficient<sup id="fnref:3" role="doc-noteref"><a href="#fn:3" class="footnote" rel="footnote">5</a></sup>:</p>

\[I=I_\text{o} · e^{-\tau s}\]

<p>This helps us understand how scattering is first modelled in Nvidia’s GPU gem on volumetric light scattering<sup id="fnref:7" role="doc-noteref"><a href="#fn:7" class="footnote" rel="footnote">6</a></sup>. Let \(s\) be the distance through the media and \(\theta\) the angle between the viewer and the light beam:</p>

<p><img src="/images/rendering-scatter-terms.png" alt="scattering-terms" /></p>

\[\definecolor{steadyblue}{RGB}{0,76,212} %004CD4
\definecolor{lobster}{RGB}{185,138,162} %B98AA2
\definecolor{mars}{RGB}{255,165,44} %FFA52C
\definecolor{rosamund}{RGB}{198,73,255} %C649FF
\definecolor{gold}{RGB}{255,206,63} %FFCE3F
\definecolor{bleu}{RGB}{73,214,255} %49D6FF
\definecolor{pistacho}{RGB}{118,163,39} %76A327
\definecolor{sea}{RGB}{41,153,124}  %29997C 
\definecolor{greenbean}{RGB}{76,153,0}  %4C9900 

\color{red}{L(s,\,\theta)} \color{black}{\,=\,} \color{steadyblue}{L_\text{o}} \color{rosamund}{\,e^{-\tau s}} \color{black}{\,+\,} \frac{1}{\tau} \color{orange}{\,E_{sun}} \color{greenbean}{\,S(\theta)} \color{black}{\,(1 \,-\, } \color{rosamund}{e^{-\tau s}}\color{black}{)}\]

<p>The <font color="FF0000">light accounting for volumetric scattering</font> is a linear interpolation <font color="C649FF">weighed by the extinction constant</font>. Note how we interpolate between the <font color="004CD4">light computed at a given point</font> and the light due to scattering, which is a product of the <font color="FFAF00">source illumination</font> from the sun (or light source) and the <font color="4C9900">angular scattering term</font> according to Rayleigh and Mie properties.</p>

<p>Let’s talk a bit about the <font color="4C9900">Rayleigh and Mie term</font>, it’s a function of particle size, shape and composition of the medium we traverse. This component and the extinction coefficient model the atmosphere or space through which light scatters.</p>

<p>In a nutshell, smaller particles scatter according to the Rayleigh model, and larger particles according to Mie. In this context we consider smaller particles the ones much smaller than the wavelength of incoming light.</p>

<p>This means Rayleigh scattering bounces off smaller wavelengths, such as the blue spectrum. Mie on the other hand, is not dependent on wavelength, and it scatters the whole spectrum of light. Clouds are white because sunlight is white.</p>

<div class="Container">
    <div class="Content">
<img class="imagedropshadow" src="/images/rayleigh-meow.png" alt="Rayleigh and Mie scattering describes how light scatters off of molecules in a medium depending on the size of those molecules. Smaller molecules respond to Mie scattering more than Rayleigh and viceversa.[^44]" />  
    </div>
</div>
<p><span class="caption" style="font-size: 80%"><i>Rayleigh and Mie scattering describes how light scatters off of molecules in a medium depending on the size of those molecules. Smaller molecules respond to Mie scattering more than Rayleigh and viceversa.<sup id="fnref:44" role="doc-noteref"><a href="#fn:44" class="footnote" rel="footnote">7</a></sup></i></span></p>

<h2 id="occlusion">Occlusion</h2>

<p>Last but not least, we need to take occluders into the equation. Let \(\phi\) represent the ray from the light emitter towards the observed point:</p>

\[L(s,\,\theta,\,\phi) = (1 \,-\, \color{orange}{D(\phi)}\color{black}{)} \color{red}{\,L(s,\,\theta)}\]

<p>Is the light accounting for both <font color="FF0000">volumetric light scattering</font> and <font color="FFA600">the opacity term of all occluders</font>, which is the total opacity of the ocluders along the ray.</p>

<p>This term accumulates objects’ opacity. If there’s a solid object between light source and observer all light energy will be zeroed, however we must account for indirect light as well as seen in eq. 1.</p>

<h2 id="wrap-up">Wrap up</h2>

<p>This covers a shallow walk through the theory of visible light and atmospheric scattering. With the information above we should be able to compute the light <em>energy</em> towards the viewer for any point in space, note that we left out things like light wavelength for simplicity. I hope you have enough to get started.</p>

<p>In the next entry I will demonstrate these concepts implementing volumetric shafts of light with GLSL, completely dismissing all we learnt here and just hacking our way to rendered images.</p>

<p><a href="/2017/12/04/light-shafts-pt-2.html">Continue to part 2</a></p>

<hr />

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:100" role="doc-endnote">
      <p><a href="https://en.wikipedia.org/wiki/Bidirectional_reflectance_distribution_function">Bidirectional reflectance distribution function</a> <a href="#fnref:100" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:1" role="doc-endnote">
      <p><a href="https://en.wikipedia.org/wiki/Rendering_equation">Rendering equation</a> <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:2" role="doc-endnote">
      <p><a href="http://adereth.github.io/blog/2013/11/29/colorful-equations/">Colorful equations with MathJax</a> <a href="#fnref:2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:4" role="doc-endnote">
      <p><a href="http://www.nbi.dk/~ogendal/personal/lho/lightscattering_theory_and_practice.pdf">Light Scattering Demystified - Theory and Practice, Lars Øgendal</a> <a href="#fnref:4" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:3" role="doc-endnote">
      <p><a href="https://www.youtube.com/watch?v=AuA2EAgAegE">Why number \(e\)?</a> <a href="#fnref:3" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:7" role="doc-endnote">
      <p><a href="https://developer.nvidia.com/gpugems/GPUGems3/gpugems3_ch13.html">Nvidia GPU Gems, Chapter 13. Volumetric Light Scattering as a Post-Process</a> <a href="#fnref:7" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:44" role="doc-endnote">
      <p>Image based on <a href="http://hyperphysics.phy-astr.gsu.edu/hbase/atmos/blusky.html">Hyperphysics scattering post</a> and derived from <a href="https://commons.wikimedia.org/wiki/File:Mie_scattering.svg">Sharayanan’s work</a>. Under the <a href="https://creativecommons.org/licenses/by-sa/3.0/deed.en">Creative Commons Attribution-Share Alike 3.0 Unported</a> licence. <a href="#fnref:44" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>]]></content><author><name>Sergio Basurco</name></author><summary type="html"><![CDATA[This post is greatly based on the Nvidia GPU Gem on volumetric light scattering. Here I walk you through the formulae and core concepts. I highly recommend reading that one instead, and come back only if you couldn’t follow, or for fun. If you’re unfamiliar with computer graphics, I highly recommend you to watch John Carmack’s talk on lighting and rendering.]]></summary></entry><entry><title type="html">Methodical selection</title><link href="https://chuckleplant.github.io/2017/01/29/industry-and-software.html" rel="alternate" type="text/html" title="Methodical selection" /><published>2017-01-29T00:00:00+01:00</published><updated>2017-01-29T00:00:00+01:00</updated><id>https://chuckleplant.github.io/2017/01/29/industry-and-software</id><content type="html" xml:base="https://chuckleplant.github.io/2017/01/29/industry-and-software.html"><![CDATA[<p>Software development has too many edges and it can be a completely different thing for two slightly different teams. Even within a single company, the methodology between teams might not be the same.</p>

<p>As it happens with programming languages, there’s no <em>one size fits all</em>. You get to know a programming language a lot better once you know how it’s compiled, loaded to memory and executed. This is what I’m trying to do with methodologies. Consider this as an introspection of my somewhat limited experience.`</p>

<p>In order to understand the nature of software development, what helped me was a comparison Albert Gil, a colleague from <a href="http://happycomputing.cat/">Happy Computing</a> made between software products and hardware products. Hardware products are old, and it’s to be expected that with the years comes knowledge and expertise. Software is new, but spreads quickly. If evolution tells us something about this is that we’ll have some weird mutants before we can have a well defined specimen.</p>

<h2 id="same-old-same-old">Same old, same old</h2>

<p>Early on, people tried to apply hardware production chains to software. It was the most intuitive and logical way to do things. For hardware it’s actually the only way it can work, each step needs the previous one. Let’s take quick broad look at the stages.</p>

<ul>
  <li>Have an idea</li>
  <li>Analyse what it solves</li>
  <li>Design the product</li>
  <li>Build the product</li>
  <li>See if it works</li>
  <li>Sell it</li>
</ul>

<p>Sounds familiar?</p>

<p><img src="/images/waterfall.png" alt="waterfall-diagram" /></p>

<p>Behold the <a href="https://en.wikipedia.org/wiki/Waterfall_model">waterfall software model</a>. This is the one I learnt during my years in university. I actually thought that’s how all companies would be making software, because why would you not?</p>

<h2 id="what-you-see-is-what-you-get">What you see is what you get</h2>

<p>Giants in the industry are by definition the leading force. In the early years those were the ones making hardware. Therefore, they were the ones with means (money) to start making software. It’s a no brainer, they applied the methodology they knew to the products they didn’t.</p>

<p>And it worked! The waterfall methodology is a solid solution, easy to relate to for the stakeholders and producers. It is very convenient for them because they get a sense of the stage production is currently in. This methodology was the undisputed cornerstone of software development for quite some time.</p>

<p>Now let’s find the conflict in our story. Why would the solid Waterfall…well, fall? What contenders could it have? Who was upset about the status quo back there?</p>

<h2 id="the-artist">The artist</h2>

<p><img src="/images/dat-sleeve.jpg" alt="mindingme" /></p>

<p>Ask Apple who’s more important when making the iPhone, is it the designers from California, or the assemblers from China?</p>

<p>Now ask the same question for a software product. Is the architect’s job more important than the programmer’s? I think this used to be the case. Programmers were understood as the workforce, the ones hitting the nails with a hammer. Does this mean programming is simpler? Maybe, at some point, it was. Now I think we can all agree it’s just a different task, but not necessarily a different job.</p>

<p>I remember wondering whether I wanted to be a programmer, the hardworking guy writing elegant and efficient code; or the architect/designer, wrapping my head around high level understanding of the program and the design patterns that could be used. That’s how I understood the profession worked, what I was taught.</p>

<p>Now I just thought of my job as <em>developer</em>, the guy doing software development whatever it takes. And I believe that’s what these roles have turned into.</p>

<p><img src="/images/iterative.png" alt="iterative-diagram" /></p>

<h2 id="a-new-contender">A new contender</h2>

<p>I believe it was the guys tired of hitting nails, who came up with this revolutionary idea of writing a manifesto. <a href="http://agilemanifesto.org/">The Agile manifesto</a>, which has shaped the recent years of development.</p>

<p>Newborn companies are famous for giving developers commodities, levelling the various roles in a project. Tech leads get their hands dirty with the team.</p>

<p>The key concept is treating development as a creative process, beyond labels and roles, new methodologies give somewhat more freedom to the developer to just code and deploy things that work.</p>

<h2 id="aftermath">Aftermath</h2>

<p>I’m no-one to say which methodology is the best to stick to. Waterfall works, same as agile and many other flavours. Best advice is to focus on the task, make the team happy and make sure communication is solved.</p>

<p>What can I say, I’m quite okay with agile development. It gives me a comfortable pace of work and helps me tie business and technical ends together. Seeing there has been an evolution of methodologies, I also wonder what manifesto will hit the bell next.</p>

<p>The last one that caught my eye was, <a href="http://programming-motherfucker.com/">Programming, Motherfucker. Do you speak it?</a></p>]]></content><author><name>Sergio Basurco</name></author><summary type="html"><![CDATA[Software development has too many edges and it can be a completely different thing for two slightly different teams. Even within a single company, the methodology between teams might not be the same.]]></summary></entry></feed>